<!DOCTYPE html>
<html>
  <head>
    <script src="/pantry.js"></script>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>&#129387;</text></svg>"
    /><!--  Favicon!  -->
  </head>

  <body>
    <!---------------->
    <!--  Side bar  -->
    <!---------------->
    <div id="side-bar">
      <h1 id="side-bar-title" onclick="load_dashboard()">&#129387; DataPantry </h1>
      <h3 id="side-bar-subtitle">Your Databases:</h3>
      <div id="db-list"><!-- Insert table names here --></div>
      <h3 id="side-bar-options">Dashboard</h3>
    </div>

    <!------------------------------------>
    <!--         Main content           -->
    <!------------------------------------>
    <div id="page-content">
      
      <!--  Top bar, with login buttons, etc   -->
      <div id="top-bar">
        <h2 id="top-bar-title"><!--  Insert current page name here --></h2>
        <div id="user-auth"></div>
      </div>
      <div id="error"></div>

      <!--------------->
      <!--  Landing  -->
      <!--------------->
      <div id="landing" style="display:none;">
        <div id="svg-container"><!--  Animated SVG logo is inserted here.  --></div>
      
        <h2>Cloud database management. Easy to use. 100% free.</h2>
        <p><i>
          Still in beta! Send feedback to <a href="mailto:benholland1024@gmail.com">benholland1024@gmail.com</a>
        </i></p>
        <p style="opacity: 0.5"><i>
          You can also <a href="github.com/benholland1024/pantry" target="_blank">contribute</a>!
          This is a dependency-less NodeJS project, if that's your thing. 
        </i></p>
        <br/>
        <button onclick="render_register_input()" id="landing-reg-btn">Register to create your first database!</button>
        <button onclick="boot_side_bar();" id="landing-dash-btn">Go to your dashboard!</button>
      </div>

      <!----------------->
      <!--  Dashboard  -->
      <!----------------->
      <div id="dashboard">
        <div id="dash-db-list-container" class="rounded-container">
          <h4>Your databases:</h4>
          <div id="dash-db-list">
            <div class="dash-db dash-db-empty"><br/>+ Create a Database</div>
          </div>
        </div>
      </div>

      <!----------------->
      <!--   Examples  -->
      <!----------------->
      <div id="examples">
        <div id="examples-table-of-contents" style="display: flex; justify-content: space-between;">
          <!--  Insert list of examples  -->
        </div>
        <div id="example-container"><!-- Insert examples here  --></div>
      </div>

      <!--------------------->
      <!--  User settings  -->
      <!--------------------->
      <div id="user-settings">
        <div class="user-settings-input">Username: <input id="username-settings" readonly/></div>
        <!-- <div class="user-settings-input">Display name: <input id="display-name-settings" readonly placeholder="No display name"/></div> -->
        <br/>
        <div id="dark-mode-toggle"><button onclick="toggle_darkmode()">Toggle dark mode</button></div>
        <hr/>
        <h4>Change your password:</h4>
        <div class="user-settings-input">Current password: <input type="password" id="current-password-settings"/></div>
        <div class="user-settings-input">New password: <input type="password" id="new-password-settings"/></div>
        <div class="user-settings-input">Confirm new password: <input type="password" id="confirm-new-password-settings"/></div>
        <div class="user-settings-input" id="settings-error" style="color:var(--error-red);"><!--  Insert error text here  --></div>
        <div class="user-settings-input" id="settings-success" style="color:var(--success-green);"><!--  Insert error text here  --></div>
        <button onclick="update_password()">Update password</button>
        <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><hr/>
        <h4>The danger zone:</h4>
        <p>Confirm your password to delete your account: </p>
        <input type="password" id="confirm-pass-to-delete-acct"/>
        <p>Type your username to delete your account: </p>
        <input type="text" id="confirm-username-to-delete-acct" placeholder="Confirm your username"/>
        <div class="user-settings-input" id="delete-acct-error" style="color:var(--error-red);"><!--  Insert error text here  --></div>
        <button onclick="delete_account()" style="background: var(--red-bg)">Delete your account</button>
      </div><!--  End user settings  -->

      <!-- Table display stuff -->
      <div id="table-display"><!-- Insert table and controls here  --></div>
      <div id="row-editor-container"><!--  Insert row editor here  --></div>
      <div id="action-button-container"><!--  Insert button here, like "New Row" etc  --></div>

      <!--  Schema display stuff  -->
      <div id="schema-display-container">
        <div id="svg-display"><!--  Insert svgs here --></div>
        <div id="schema-display"><!--  Insert schema diagram here  --></div>
      </div>

      <!--  Db settings  -->
      <div id="db-settings-container">
        <div class="db-settings-input">Database name: <input type="text" id="db-name"></div>
        <div style="color:var(--error-red)" id="db-name-error"><!-- Error msg here --></div>
        <br/>
        <button onclick="update_db_name()">Update name</button>
        <br/><br/><br/><hr/>

        <div id="api-code-container" class="rounded-container">
          <h4>Your API key:</h4>
          <pre></pre>
          <button style="font-size: 0.8em">Copy this code!</button>
        </div>
        <br/><br/>
        <h4><!--Stats:--></h4>
        <div style="display: block;height: 30vh"></div><hr/>
        <h4>Danger zone</h4>

        <button style="background-color:var(--red-bg);margin-bottom: 30px;" onclick="delete_db()">Delete database</button>
      </div>

    </div>

  </body>
  
  <script src="/landing.js"></script>
  <script src="/dashboard.js"></script>
  <script src="/examples.js"></script>
  <script src="/utils.js"></script>
  <script src="/settings.js"></script>
  <script src="/row_editor.js"></script>
  <script src="/schema_editor.js"></script>
  <script src="/db_creator.js"></script>    <!--  Literally just the "+ Add a Database" button -->
  <script src="/db_settings.js"></script>   

  <script>

    //  GLOBAL DATA
    let _db_data =   {};                                     //  An object mapping db names to objs like { api_key: 'asdf' } 
    let _selected_db = { name: '' };                         //  The currently selected database.
    let _schema_data = [];                                   //  A list of table objects in the schema. 
    let _table_list = [];                                    //  List of table NAMES belonging to the selected DB. 
    let _selected_table = {};                                //  Current selected table obj
    let _selected_row = {};                                  //  Current selected table row.
    let _session_id = localStorage.getItem('session_id');    //  User auth session id
    let _current_user = {};
    let _event_listeners = { onmousedown: () => {} }         //  Stores event listener functions, so they can be removed.
    const http = new XMLHttpRequest();                       //  Used for HTTP requests

    const _utility_keys = [8, 9, 39, 37, 224];               //  Used for input validation. Backspace, tab, command, arrow keys

    let open_auth_box = 'none';  //  Used to do toggling of auth popups. Options: 'none', 'login', 'register'. 


    //  BOOT
    function boot() {
       
      //  If the user isn't logged in...
      if (_session_id) {
        http.open('GET', `/api/user-by-session?session_id=${_session_id}`);
        http.send();
        http.onreadystatechange = (e) => {
          if (http.readyState == 4 && http.status == 200) {
            _current_user = JSON.parse(http.responseText);
            boot_side_bar();
            render_user_profile_button();
            routing();
          } else if (http.readyState == 4 && http.status == 404) {
            console.log('No session found.');
            localStorage.removeItem('session_id');
            render_landing();
          }
        }
              
      //  Minimize the side bar if logged out
      } else {
        render_landing();
      }
      
      // Remember whether we're in dark mode
      if (localStorage.getItem('light-mode') == 'true') {
        toggle_darkmode();
      }
    }
    boot();

    function routing() {
      load_dashboard();
    }



    ////
    ////  RENDER user auth
    ////
    function render_auth_buttons() {
      //  Rendering login and register buttons
      document.getElementById('user-auth').innerHTML = `<div>`;
      document.getElementById('user-auth').innerHTML += '<button onclick="render_login_input()">Log in</button>&nbsp;&nbsp;&nbsp;&nbsp;';
      document.getElementById('user-auth').innerHTML += '<button onclick="render_register_input()">Register</button>';
      document.getElementById('user-auth').innerHTML += `</div>`;

    }

    function render_login_input() {
      if (open_auth_box == 'login') { 
        render_auth_buttons();  
        open_auth_box = 'none';
        return;  
      }
      open_auth_box = 'login';
      let auth_input_html = '<div id="auth-input-box"><h3>Log in: </h3>';
      auth_input_html += '<div>Username: <input id="username"/> </div><br/>';
      auth_input_html += '<div>Password: <input id="pass" type="password" /></div><br/>';
      auth_input_html += `<div id="auth-error"><!--  Insert errors here  --></div>`;
      auth_input_html += '<div><button onclick="login()">Log in</button>&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="render_auth_buttons()">Close</button></div>';

      auth_input_html += '</div>';
      render_auth_buttons();
      document.getElementById('user-auth').innerHTML += auth_input_html;
      //  Username -- lowercase alphanumeric and _ only
      const username_input = document.getElementById('username');
      const username_regex = /^[a-z0-9_]*$/;
      username_input.addEventListener("keydown", event => {
        if (!username_regex.test(event.key) && !_utility_keys.includes(event.keyCode)) {
          event.preventDefault();
          document.getElementById('auth-error').innerHTML = "Username can only contain lowercase letters, numbers, and underscores.";
        } else {
          document.getElementById('auth-error').innerHTML = "";
        }
      });
    }

    function render_register_input() {
      if (open_auth_box == 'register') { 
        render_auth_buttons();  
        open_auth_box = 'none';
        return;  
      }
      open_auth_box = 'register';
      let auth_input_html = '<div id="auth-input-box"><h3>Register: </h3>';
      auth_input_html += '<div>Username: <input id="username"/> </div><br/>';
      // auth_input_html += '<div>Display name: <input id="display-name"/> </div><br/>';
      auth_input_html += '<div>Password: <input id="pass" type="password" /></div><br/>';
      auth_input_html += '<div>Confirm pass: <input id="confirm-pass" type="password" /></div><br/>';
      auth_input_html += `<div id="auth-error"><!--  Insert errors here  --></div>`;
      auth_input_html += '<div><button onclick="register()">Register</button>&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="render_auth_buttons()">Close</button></div>';

      auth_input_html += '</div>';
      render_auth_buttons();
      document.getElementById('user-auth').innerHTML += auth_input_html;

      //  Username -- lowercase alphanumeric and _ only
      const username_input = document.getElementById('username');
      const username_regex = /^[a-z0-9_]*$/;
      username_input.addEventListener("keydown", event => {
        if (!username_regex.test(event.key) && !_utility_keys.includes(event.keyCode)) {
          event.preventDefault();
          document.getElementById('auth-error').innerHTML = "Username can only contain lowercase letters, numbers, and underscores.";
        } else {
          document.getElementById('auth-error').innerHTML = "";
        }
      });
    }

    function render_user_profile_button() {
      document.getElementById('user-auth').innerHTML = `<button onclick="render_user_options()">&#x1F464; ${_current_user.username}</button>&nbsp;&nbsp;&nbsp;&nbsp;`;
    }

    function render_user_options() {
      if (open_auth_box == 'user-options') { 
        render_user_profile_button();  
        open_auth_box = 'none';
        return;  
      }
      open_auth_box = 'user-options';
      let auth_input_html = `<div id="auth-input-box" class="auth-popup-vertical">
        <button onclick="load_settings()">Settings</button>
        <button onclick="logout()">Log out</button>
        <button onclick="render_user_options()">Close</button>
      </div>`;

      auth_input_html += '</div>';
      render_user_profile_button();
      document.getElementById('user-auth').innerHTML += auth_input_html;

    }

    ////
    ////  RENDER side bar
    ////

    //  First start up the side bar. 
    //    This gets the databases. 
    function boot_side_bar() {
      //  Get all db data
      http.open("GET", `/api/all-databases?username=${_current_user.username}`);
      http.send();
      http.onreadystatechange = (e) => {
        if (http.readyState == 4 && http.status == 200) {
          let response = JSON.parse(http.responseText);
          if (!response.error) {
            _db_data = response.data;
            render_side_bar();
            //  The dashboard also relies on this data, so if we're on that page, refresh it. 
            if (window.location.pathname.split('/')[1] == 'dashboard') {
              render_dashboard();
            }
          } else {
            document.getElementById('error').innerHTML = response.msg;
          }
        }
      }

    }

    //  This renders all the side bar components.  Used any time a new DB or table is selected. 
    function render_side_bar() {
      document.getElementById('side-bar-title').innerHTML = '&#129387; DataPantry';
      document.getElementById('side-bar-subtitle').innerHTML = 'Your Databases:'
      document.getElementById('side-bar').style.width = '300px';
      document.getElementById('side-bar').style['min-width'] = '300px';
      document.getElementById('db-list').innerHTML = '';
      let selected_class = '';   //  Used to add class="selected" to certain options
      let db_list = _db_data ? Object.keys(_db_data) : [];
      for (let i = 0; i < db_list.length; i++) {
        selected_class = 'selected';
        if (_selected_db.name != db_list[i]) {  selected_class = ''; }
        document.getElementById('db-list').innerHTML += `<div class="db-name ${selected_class}" onclick="load_database('${db_list[i]}')">
          ${db_list[i]} 
          <span class="db-setting-icon" onclick="load_db_settings('${db_list[i]}', event)">&#9881;<!-- gear icon  --></span>
        </div>`;
        //  Render list of DB tables, if the DB is selected:
        if (_selected_db.name == db_list[i]) {
          for (let j = 0; j < _table_list.length; j++) {
            selected_class = '';
            if (_selected_table.metadata && _table_list[j] == to_snakecase(_selected_table.metadata.name)) {  selected_class = 'selected';  }
            document.getElementById('db-list').innerHTML += `<div class="table-name ${selected_class}" onclick="load_table('${_table_list[j]}')">${_table_list[j]}</div>`;
          }
          selected_class = window.location.pathname.split('/')[3] == 'create-table' ? 'selected' : '';
          document.getElementById('db-list').innerHTML += `<div class="create-new-table ${selected_class}" onclick="create_table()">+ Create a table</div>`;
        }
      }
      document.getElementById('db-list').innerHTML += `<div class="create-new-database" onclick="create_db()">+ Create a database</div>`;

      //  Side bar options, at the bottom
      selected_class = window.location.pathname.split('/')[1] == 'dashboard' ? 'selected' : '';
      document.getElementById('side-bar-options').innerHTML = `<div class="${selected_class}" onclick="load_dashboard()">Dashboard</div>`;
      selected_class = window.location.pathname.split('/')[1] == 'examples' ? 'selected' : '';
      document.getElementById('side-bar-options').innerHTML += `<div class="${selected_class}" onclick="load_examples()">Examples</div>`

    }

    function minimize_side_bar() {
      document.getElementById('side-bar-title').innerHTML = "&#129387;";
      document.getElementById('side-bar-subtitle').innerHTML = "";
      document.getElementById('db-list').innerHTML = "";
      document.getElementById('side-bar').style.width = "60px";
      document.getElementById('side-bar').style['min-width'] = "60px";
      document.getElementById('side-bar-options').innerHTML = "";
    }

   
    

    ////
    ////  DATA HANDLING - databases
    ////

    //  Load a list of all tables in a database
    function load_database(db_name) {
      _selected_db.name = db_name;
      Pantry.get_all_tables(_current_user.username, db_name, function(response) {
        if (!response.error) {
          _table_list = response;
          render_side_bar();
          load_schema();
        } else {
          document.getElementById('error').innerHTML = response.msg;
        }
      });
    }

    function register() {
      let username = document.getElementById('username').value;
      // let display_name = document.getElementById('display-name').value;
      let password = document.getElementById('pass').value;
      let confirm = document.getElementById('confirm-pass').value;
      if (password != confirm) {
        document.getElementById('auth-error').innerHTML = `Passwords must match.`;
        return;
      } else if (username.length < 1) {
        document.getElementById('auth-error').innerHTML = `Username required.`;
        return;
      } else if (password.length < 4) {
        document.getElementById('auth-error').innerHTML = `Password must be at least 4 characters.`;
        return;
      }

      http.open('POST', '/api/register');
      http.send(JSON.stringify({
        username: username,
        password,
        // display_name
      }));
      http.onreadystatechange = (e) => {
        let response;      
        if (http.readyState == 4 && http.status == 200) {
          response = JSON.parse(http.responseText);
          if (!response.error) {
            console.log("Response recieved! Logging you in.");
            localStorage.setItem('session_id', response.session_id);
            console.log(localStorage.getItem('session_id'))
            _session_id = response.session_id;
            _current_user = {
              id: response.id,
              username,
              // display_name
            };
            boot_side_bar();
            render_user_profile_button();  //  Close the register popup.
            load_dashboard();
            open_auth_box = 'none';  //  Mark the register popup as closed.
          } else if (response.msg == 'Username must be unique.') {
            document.getElementById('auth-error').innerHTML = `The username "${username}" is already taken. Sorry!`;
          } else {
            document.getElementById('auth-error').innerHTML = response.msg;
          }
        }
      }
    }

    function login() {
      var username = document.getElementById('username').value;
      var password = document.getElementById('pass').value;

      if (username.length < 2) {
        document.getElementById('auth-error').innerHTML = 'Valid username required.';
        return;
      }

      http.open("POST", "/api/login");
      http.send(JSON.stringify({
        username: username,
        password
      }));
      http.onreadystatechange = (e) => {
        let response;      
        if (http.readyState == 4 && http.status == 200) {
          response = JSON.parse(http.responseText);
          if (!response.error) {
            console.log("Response recieved! Logging you in.");
            localStorage.setItem('session_id', response.session_id);
            _session_id = response.session_id;
            _current_user = {
              id: response.user_data.id,
              username: response.user_data.username,
              // display_name: response.user_data.display_name
            };
            boot_side_bar();
            render_user_profile_button();  //  Close the login popup.
            load_dashboard();
            open_auth_box = 'none';  //  Mark the login popup as closed.
          } else {
            document.getElementById('auth-error').innerHTML = response.msg;
          }
        }
      }
    }

    function logout() {
      http.open("POST", "/api/logout");
      http.send(_session_id);
      http.onreadystatechange = (e) => {
        if (http.readyState == 4 && http.status == 200) {
          localStorage.removeItem('session_id'); //  sets to null
          _current_user = {};
          _session_id = null;
          render_user_profile_button();  //  Close the register popup.
          open_auth_box = 'none';  //  Mark the register popup as closed.
          render_landing();
        }
      }
    }
  </script>

  <style>
    body {
      color: var(--text-color);
      background: var(--content-bg-desat);
      display: flex;
      font-family: sans-serif;
      /* overflow: hidden; */
      padding: 0px;
      margin: 0px;

      --background: black;

      --text-color: white;
      --text-color-transluscent: rgba(255,255,255,0.5);

      --box-shadow: 2px 2px 10px black;

      --content-bg: hsl(240, 55%, 8%);
      --content-bg-transluscent: hsla(240, 55%, 8%, 0.5);
      --content-bg-desat: hsl(from var(--content-bg) h calc(s - 40) l);
      --content-bg-desat-dark1: hsl(from var(--content-bg) h calc(s - 40) calc(l - 2));
      --content-bg-desat-light1: hsl(from var(--content-bg) h calc(s - 40) calc(l + 5));
      --content-bg-desat-light2: hsl(from var(--content-bg) h calc(s - 40) calc(l + 10));
      --content-bg-desat-light3: hsl(from var(--content-bg) h calc(s - 40) calc(l + 15));
      --content-bg-dark2: hsl(from var(--content-bg) h s calc(l - 5));
      --content-bg-dark1: hsl(from var(--content-bg) h s calc(l - 2));
      --content-bg-light1: hsl(from var(--content-bg) h s calc(l + 5));
      --content-bg-light2: hsl(from var(--content-bg) h s calc(l + 10));
      --content-bg-light3: hsl(from var(--content-bg) h s calc(l + 15));

      --content-bg-alt: hsl(194, 78%, 16%);
      --content-bg-alt-light2: hsl(from var(--content-bg-alt) h calc(s - 40) calc(l + 10));;

      --action-bg: rgb(43, 3, 38);
      --action-bg-light1: hsl(from var(--action-bg) h calc(s - 40) calc(l + 5));
      --red-bg: rgb(126, 12, 27);

      --error-red: rgb(223, 91, 91);
      --success-green: rgb(97, 202, 97);

      /*  Syntax highlighting */
      --green: rgb(112, 163, 92);
      --pink: pink;
      --yellow: rgb(245, 245, 174);
      --orange: rgb(236, 158, 113);
      --blue: rgb(123, 194, 194);
    }
    body.light-mode {
      color: var(--text-color);
      background: var(--background);

      --background: white;

      --text-color: black;
      --text-color-transluscent: rgba(0,0,0,0.5);

      --content-bg: hsl(209, 86%, 78%);
      --content-bg-transluscent: hsla(209, 86%, 78%, 0.5);

      --content-bg-alt: hsl(194, 78%, 49%);

      --action-bg: rgb(203, 156, 221);
      --red-bg: rgb(255, 112, 131);

      --error-red: rgb(212, 147, 147);
      --success-green: rgb(97, 202, 97);

      --green: rgb(55, 92, 41);
      --pink: rgb(165, 37, 59);
      --yellow: rgb(119, 82, 2);
      --orange: rgb(139, 56, 8);
      --blue: rgb(64, 74, 117);

    }
    /*  This is used in several places - dashboard, db settings, examples */
    .rounded-container {
      text-align: left;
      margin: 20px;
      padding: 10px;
      background: var(--content-bg-light1);
      border-radius: 10px;
      box-shadow: var(--box-shadow);
    }
    .rounded-container pre {
      background: var(--content-bg-dark1);
      padding: 10px;
      border-radius: 10px;
      font-size: 1.2em;
    }

    /********************/
    /*  Side bar styles */
    /********************/
    #side-bar {
      width: 300px;
      min-width: 300px;
      height: 100vh;
      background: var(--content-bg-desat-dark1);
      box-sizing: border-box;
      transition-duration: 0.5s;
      transition-property: width;
      position: sticky;
      top: 0px;
    }
    #side-bar h1, #side-bar-subtitle {
      padding: 10px;
    }
    #side-bar h1 {
      font-size: 1.5em;
      /* font-family: serif; */
      background: var(--content-bg-dark2); 
      margin-top: 0px; 
      padding: 15px;
    }
    #side-bar-title {
      cursor: pointer;
      user-select: none;
    }
    #side-bar-subtitle {
      margin-bottom: 0px;
      padding-bottom: 0px;
      opacity: 0.5;
      font-weight: normal;
      font-size: 1em;
    }
    #side-bar div {
      padding: 10px;
    }

    .db-name {
      position: relative;
    }
    .db-name::before {
      content: '\25B8  ';
    }
    .db-name.selected::before {
      content: '\25BE  ';
    }
    .db-setting-icon {
      position: absolute;
      padding: 5px;
      right: 5px;
      top: 5px;
    }
    .db-setting-icon:hover {
      transform: scale(1.3);
    }
    .table-name, .create-new-table, .db-name, .create-new-database, #side-bar-options div {
      cursor: pointer;
      opacity: 0.5;
      overflow: ellipse;
    }
    .create-new-table, .create-new-database {
      font-weight: bold;
    }
    .table-name, .create-new-table {  /*  These are indented */
      padding-left: 35px !important;
      background:var(--content-bg-desat-light1);
      font-size: 0.8em;
    }
    .selected {
      background: var(--content-bg-desat-light1);
      font-weight: bold;
      opacity: 1;
    }
    .db-name.selected {
      background: var(--content-bg-desat);
    }
    .table-name:hover, .create-new-table:hover, .db-name:hover, .create-new-database:hover {
      background: var(--content-bg-desat-light2);
      color: var(--text-color);
      opacity: 1;
    }
    #side-bar-options {
      position: absolute;
      bottom: 0px;
      width: 100%;
      z-index: 4;
      background: var(--content-bg-desat-dark1);
    }
    #side-bar-options div.selected {
      background: var(--content-bg-desat-light1);
      font-weight: bold;
      opacity: 1;
    }

    
    /*  Main content  */
    #page-content {
      text-align: center;
      padding-top: 0px;
      background: var(--content-bg-desat);
      min-height: 100vh;
      flex-grow: 1;
      position: relative;
    }
    #top-bar {
      width: 100%;
      position: sticky;
      z-index: 3;
      top: 0px;
      background: var(--content-bg-desat-dark1);
      padding: 10px 20px;
      box-sizing: border-box;
      text-align: left;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    #top-bar h1 {
      font-size: 1.5em;
      margin: 0px;
      padding: 0px;
    }

    /*  Log in   */
    #user-auth {
      position: relative;
      z-index: 3;
    }
    #auth-input-box {
      position: absolute;
      z-index: 3;
      min-width: 230px;
      top: 60px;
      right: 20px;
      background: rgba(50, 50, 192, 0.1);

      backdrop-filter: blur(20px);
      border-radius: 10px;
      /* border: solid var(--content-bg-light1) 3px; */
      box-shadow: var(--box-shadow);
      padding: 15px;
      box-sizing: border-box;
    }
    #auth-error {
      color: var(--error-red);
      padding-bottom: 4px;
      max-width: 300px;
      text-wrap: wrap;
    }
    .auth-popup-vertical {
      min-height: 100px;
      display: flex; 
      flex-direction: column;
      gap: 10px;
    }

    /*************/
    /*  Landing  */
    /*************/
    #landing {
      display: none;
      width: 75%;
      margin: 0 auto;
      padding-bottom: 100px;
    }
    #landing img {
      margin-top: 100px;
    }
    #landing button {
      margin: 0px auto;
    }

    /***************/
    /*  Dashboard  */
    /***************/
    #dashboard {
      width: 100%;
      height: calc(100vh - 50px);
      display: none;
    }
    
    .pink {
      color: var(--pink);
    }
    .yellow {
      color: var(--yellow);
    }
    .blue {
      color: var(--blue);
    }
    .green {
      color: var(--green);
    }
    .orange {
      color: var(--orange);
    }
    #dash-db-list {
      display: flex;
      flex-flow: row wrap;
      margin-bottom: 10px;
    }
    .dash-db {
      width: 200px;
      height: 100px;
      padding: 10px;
      box-sizing: border-box;
      border-radius: 10px;
      text-align: center;
      /* cursor: pointer; */
      background: var(--content-bg-alt);
      margin: 5px;
      box-shadow: var(--box-shadow);
      color: var(--text-color-transluscent);
    }
    .dash-db:nth-child(odd) {
      background: var(--content-bg-alt-light2);
    }
    .dash-db:hover {
      filter: brightness(1.2);
      color: var(--text-color);
    }
    .dash-db button {
      opacity: 0.5;
    }
    .dash-db:hover button {
      opacity: 1;
    }
    .dash-db-empty {
      border: dashed 2px var(--text-color-transluscent);
      color: var(--text-color-transluscent);
      background: none !important;
      box-shadow: none;
      cursor: pointer;
    }
    .dash-db-empty:hover {
      border: dashed 2px var(--text-color);
      color: var(--text-color);
    }


    /***************/
    /*  Examples   */
    /***************/
    #examples {
      display: none;
    }
    #examples-table-of-contents li {
      cursor: pointer;
      margin-bottom: 5px;
    }
    #examples-table-of-contents li:not(.non-active-example):hover {
      text-decoration: underline;
    }
    .non-active-example {
      opacity: 0.5;
      cursor: auto;
    }
    .selected-ex {
      font-weight: bold;
    }

      /***************/
    /** User settings **/
      /***************/
    #user-settings {
      width: 100%;
      min-height: calc(100vh - 50px);
      display: none;
      text-align: left;
      padding: 25px;
      box-sizing: border-box;
    }
    .user-settings-input {
      text-align: left;
      margin: 10px;
      width: 400px;
      display: flex;
      justify-content: space-between;
    }

    /*  Tables  */
    #top-bar-title {
      padding: 0px;
      margin: 0px;
      font-weight: normal;
      font-size: 1em;
    }
    table {
      margin: 30px auto 0px auto;
      width: 95%;
      table-layout: fixed;
      overflow: scroll;

      border-collapse: collapse;
      box-shadow: var(--box-shadow);
    }
    tr {
      overflow: scroll;
    }
    tr input {
      width: 100%;
      background: none;
      text-align: center;
      margin: -5px 0px;
    }
    tr:nth-child(even) {
      background: var(--content-bg-light1);
    }
    tr:nth-child(odd) {
      background: var(--content-bg-light2);
    }
    tr:nth-child(1) { /*  The header row  */
      background: var(--content-bg-dark2);
    }
    tr:not(tr:nth-child(1)):hover {
      background: var(--content-bg-light3);
    }
    tr.selected-row {
      background: var(--content-bg-light3);
      font-weight: bold;
    }
    .table-row-icon {
      width: 20px;      
    }
    .edit-row-icon, .delete-row-icon, .save-row-icon {
      margin-top: -5px;
      margin-bottom: -10px; /*  Prevents issues with the icon being too big */
      cursor: pointer;
    }
    .edit-row-icon:hover, .delete-row-icon:hover, .save-row-icon:hover {
      transform: scale(1.3);
    }
    .edit-row-icon, .delete-row-icon {
      display: none;
    }
    tr:hover .edit-row-icon, tr:hover .delete-row-icon {
      display: block;
    }
    td, th {
      /* border: 1px solid white; */
      padding: 15px;
      overflow-x: scroll;
    }
    td::-webkit-scrollbar, th::-webkit-scrollbar {
      width: 0;
      height: 0;
    }
    #empty-table-space {
      background: var(--content-bg-light1);
      box-shadow: var(--box-shadow);
      margin: 0px auto;
      padding: 30px 0px;
      width: 95%;
    }

    input {
      background: var(--content-bg-light3);
      color: var(--text-color);
      border: none;
      padding: 4px;
      font-size: 1em;
    }
    input:disabled, select:disabled {
      cursor: auto;
    }
    button {
      background: var(--action-bg);
      box-shadow: var(--box-shadow);
      color: var(--text-color);
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 1em;
      cursor: pointer;
    }
    button:hover {
      filter: brightness(1.5)
    }


    /* Button to create a new row.   */
    #action-button-container {
      position: absolute;
      bottom: 20px;
      right: 20px;
      z-index: 3;
    }

    select, option {
      background: var(--content-bg);
      color: var(--text-color);
      outline: none;
      border: none;
      cursor: pointer;
    }

    /*********************************/
    /*        Table editor           */
    /*********************************/
    #table-name-input-container {
      /*  */
    }
    #table-name-input {
      background: var(--content-bg-desat-light3);
    }
    #table-snakecase-container {
      margin-top: 5px;
      opacity: 0.5;
      font-size: 0.9em;
    }

    /*********************************/
    /*        Schema editor          */
    /*********************************/
    #schema-display-container {
      position: relative;
      overflow: hidden;
      min-height: calc(100vh - 59px);
      background-color: var(--content-bg-desat);
      opacity: 0.8;
      background: linear-gradient(
        135deg, 
        var(--content-bg-transluscent) 25%, 
        transparent 25%) -10px 0/ 20px 20px, 
        linear-gradient(225deg, var(--content-bg) 25%, transparent 25%) -10px 0/ 20px 20px, 
        linear-gradient(315deg, var(--content-bg-transluscent) 25%, transparent 25%) 0px 0/ 20px 20px, 
        linear-gradient(45deg, var(--content-bg) 25%, var(--background) 25%) 0px 0/ 20px 20px;    
    }
    .light-mode #schema-display-container {
      background: linear-gradient(
        135deg, 
        var(--content-bg-light3) 25%, 
        transparent 25%) -10px 0/ 20px 20px, 
        linear-gradient(225deg, var(--content-bg-light2) 25%, transparent 25%) -10px 0/ 20px 20px, 
        linear-gradient(315deg, var(--content-bg-light3) 25%, transparent 25%) 0px 0/ 20px 20px, 
        linear-gradient(45deg, var(--content-bg-light2) 25%, var(--background) 25%) 0px 0/ 20px 20px;   
    }
    #schema-display  {
      position: relative;
      height: calc(100vh - 80px);
    }
    .schema-table {
      position: absolute;
      min-width: 250px;
      background: var(--content-bg-light1);
      box-sizing: border-box;
      box-shadow: var(--box-shadow);
    }
    .schema-table-name {
      background: var(--content-bg-light2);
      margin: 0px;
      padding: 10px 15px;
      position: relative;
    }
    .schema-table-icon {
      position: absolute;
      right: 10px;
      top: 10px;
      cursor: pointer;
      display: none;
    }
    .schema-add-a-column-btn {
      font-size: 0.8em;
      padding: 2px;
      cursor: pointer;
      opacity: 0.6;
    }
    .schema-add-a-column-btn:hover {
      font-weight: bold;
      opacity: 1;
    }
    .table-mover {
      left:12px;
      top: 12px;
      right:auto;
      cursor: grab;
    }
    .schema-table-icon:hover {
      transform: scale(1.3);
    }
    .schema-table-name:hover .schema-table-icon {
      display: block;
    }
    .schema-table-name input {
      background: none;
      text-align: center;
      padding: 0px;
      width: calc(100% - 40px);
    }
    .schema-table-column {
      margin: 5px 15px;
      display: flex;
      justify-content: space-between;
      font-size: 0.8em;
      position: relative;
    }
    .schema-table-column select {
      field-sizing: content;
    }
    .schema-table-column input {
      padding: 0px;
    }
    .fk-input, .fk-output {
      height: 14px;
      top: 2px;
      position: absolute;
    }
    .fk-input {
      width: 7px;
      background: rgb(68, 68, 66);
      left: -22px;
      border-radius: 7px 0px 0px 7px;
      transition-duration: 0.5s;
    }
    .light-mode .fk-input {
      background: rgb(62, 103, 216);
    }
    .fk-output {
      width: 10px;
      background: rgb(150, 133, 92);
      right: -27px;
      border-radius: 0px 7px 7px 0px;
      cursor: grab;
    }
    .light-mode .fk-output {
      background: rgb(183, 113, 204);
    }
    .connected-input {
      cursor: grab;
      background: rgb(202, 202, 202);
    }
    .cursor-grabbing {
      cursor: grabbing;
    }
    .cursor-grabbing * {
      cursor: grabbing;
    }


    /******************/
    /*  DB settings   */
    /******************/
    #db-settings-container {
      width: 100%;
      height: calc(100vh - 50px);
      display: none;
      text-align: left;
      padding: 25px;
      box-sizing: border-box;
    }

  </style>

</html>